\section{Libraries testing}
\subsection{config\textunderscore lib}
\subsubsection{Utilities}
\paragraph{LT-CON-010 -- Tilde expansion nominal}
The tilde expansion function shall perform the following application,
\lstinline{~/.config/timesheeting/timesheeting.toml}
$\rightarrow$ \lstinline{<home>/timesheeting/timesheeting.toml},
with \lstinline{<home>} the current \lstinline{$HOME}.

\textit{Tests: } LR-CON-010 -- Tilde expansion utility

\paragraph{LT-CON-020 -- Tilde expansion none}
The tilde expansion function shall return an identical filepath to the
input \lstinline{/etc/timesheeting/timesheeting.toml}.

\textit{Tests: } LR-CON-010 -- Tilde expansion utility

\paragraph{LT-CON-030 -- First existing file found}
Given a directory structure as follows,
\dirtree{%
  .1 ...
  .2 dir1.
  .3 subdir1.
  .2 dir2.
  .3 timesheeting.toml.
  .2 dir3.
}
the \emph{first existing file utility}, when provided with the list of folders
\lstinline{dir1/subdir1, dir2, dir3} and the suffix
\lstinline{timesheeting.toml}
must return the path \lstinline{dir2/timesheeting.toml}.

\textit{Tests: } LR-CON-020 -- First existing file

\paragraph{LT-CON-040 -- First existing file not found}
Given a directory structure as follows,
\dirtree{%
  .1 ...
  .2 dir1.
  .3 subdir1.
  .2 dir2.
  .3 timesheeting.toml.
  .2 dir3.
}
the \emph{first existing file utility}, when provided with the list of folders
\lstinline{dir1/subdir1, dir1, dir3} and the suffix
\lstinline{timesheeting.toml} must return a nullopt.

\textit{Tests: } LR-CON-020 -- First existing file

\subsubsection{Configuration loader}
\begin{minipage}{\linewidth}
  \begin{lstlisting}[caption={TOML test configuration file.},
                     label={lst:toml_file}]
[par1]
string_arg = "Hello there."
empty_string_arg = ""

[par2]
  [par2.sub1]
  filepath_arg = "~/"
  filepath_nonexistent_arg = "/dev/null/nonexistent/nonexistent"
  [par2.sub2]
  float_arg = 8.3
  unsigned_arg = 1089
  [par2.sub3]
  vector_strings_arg = [ "hello", "there", "fox", "delta" ]
  vector_nonstrings_arg = [ 31, 1, 43 ]
\end{lstlisting} \end{minipage}

\begin{minipage}{\linewidth}
  \begin{lstlisting}[caption={TOML test configuration file.},
                     label={lst:toml_file_empty}]
[par1]
string_arg = "Hello there."
empty_arg = 
\end{lstlisting} \end{minipage}

\paragraph{LT-CON-050 -- Configuration file loading}
The configuration loader shall successfully initialize given the filepath
for \cref{lst:toml_file}.

\textit{Tests: } LR-CON-030 -- Configuration file format

\paragraph{LT-CON-060 -- Configuration file non-existent}
The configuration loader shall emit an exception when provided the
filepath \lstinline{/dev/null/nonexistent}.

\textit{Tests: } LR-CON-120 -- Configuration file nonexistent

\paragraph{LT-CON-070 -- String parameter reading}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par1.string_arg} node as a \emph{string} and return
\lstinline{"Hello there."}.

\textit{Tests: } LR-CON-040 -- String loading

\paragraph{LT-CON-080 -- String parameter empty}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par1.empty_string_arg} node as a \emph{string} and emit an exception.

\textit{Tests: } LR-CON-050 -- String empty case

\paragraph{LT-CON-090 -- Filepath reading}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par2.sub1.filepath_arg} node as a \emph{filepath}
and return \lstinline{$HOME}, set to the current \lstinline{HOME} environment
variable.

\textit{Tests: } LR-CON-060 -- Filepath loading

\paragraph{LT-CON-100 -- Filepath non-existent}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par2.sub1.filepath_nonexistent_arg} node as a \emph{filepath}
and emit an exception.

\textit{Tests: } LR-CON-070 -- Filepath parent non-existent

\paragraph{LT-CON-110 -- Float reading}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par2.sub2.float_arg} node as a \emph{float} and return
\lstinline{8.3}.

\textit{Tests: } LR-CON-080 -- Float loading

\paragraph{LT-CON-120 -- Empty parameter case}
Given \cref{lst:toml_file_empty}, the configuration loader shall emit an
exception upon loading the configuration file.

\textit{Tests: } LR-CON-090 -- Parameter empty case

\paragraph{LT-CON-130 -- Vector of strings reading}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par2.sub3.vector_strings_arg} node as a \emph{vector of strings}
and return the vector \lstinline{"hello", "there", "fox", "delta"} in order.

\textit{Tests: } LR-CON-100 -- Vector of strings loading

\paragraph{LT-CON-140 -- Vector of non-strings case}
Given \cref{lst:toml_file}, the configuration loader shall read the
\lstinline{par2.sub3.vector_nonstrings_arg} node as a \emph{vector of strings}
and emit an exception.

\textit{Tests: } LR-CON-110 -- Vector of non-strings case

\paragraph{LT-CON-150 -- Unsigned integer case}
Given \cref{lst:toml_file}, the configuration loader shall read
the \lstinline{par2.sub2.unsigned_arg} node as an
\lstinline{uint64_t} and return the value \lstinline{1089}.

\textit{Tests: } LR-CON-130 -- Unsigned integer loading

\subsection{time\textunderscore lib}
\subsubsection{time\textunderscore zone}
\paragraph{LT-TMZ-010 -- Invalid time zone}
The time\textunderscore zone object initialization shall be called with
the identifier string \lstinline{GOOFY} and emit an exception.

\textit{Tests: } LR-TMZ-030 -- Invalid time zone

\paragraph{LT-TMZ-020 -- Time zone initialization}
The time\textunderscore zone object shall be initialized with the TZ
identifier string \lstinline{Europe/Paris} without error.

\textit{Tests: } LR-TMZ-010 -- Time zone initialization

\paragraph{LT-TMZ-030 -- Time zone name}
The time\textunderscore zone singleton initialized in LT-TMZ-020 shall
be retrieved, its name queried and equal to \lstinline{Europe/Paris}.

\textit{Tests: } LR-TMZ-020 -- Time zone singleton,
                 LR-TMZ-040 -- Time zone name

\paragraph{LT-TMZ-040 -- std time\textunderscore zone}
The time\textunderscore zone singleton initialized in LT-TMZ-020 shall
be retrieved, its \lstinline{std::chrono::time_zone} object retrieved
and compared with
\lstinline{std::chrono::get_tzdb().locate_zone("Europe/Paris")}.


\textit{Tests: } LR-TMZ-020 -- Time zone singleton,
                 LR-TMZ-050 -- std time\textunderscore zone

\subsubsection{Date}
The tests for Date reuse the TimeZone singleton initialized
in LT-TMZ-020.
                 
\paragraph{LT-DAT-010 -- std::time\textunderscore point initialization}
The Date shall be initialized without error using the time point
\lstinline{std::chrono::system_clock::now()}.

\textit{Tests: } LR-DAT-020 \lstinline{std::time_point} initialization

\paragraph{LT-DAT-020 -- Date std::time\textunderscore point access}
The Date initialized in LT-DAT-010 shall be accessed through its
internal \lstinline{std::chrono::time_point} representation.
The duration between the initialization time point and the retrieved
time point shall be at most 1 second.

\textit{Tests: } LR-DAT-075 Date std::time\textunderscore point access,
LR-DAT-130 Second resolution

\paragraph{LT-DAT-030 -- Current time initialization}
The Date shall be initialized at the current time without error
and the duration between the internal \lstinline{std::chrono::time_point}
and \lstinline{std::chrono::system_clock::now()} shall be at most 1 second.

\textit{Tests: } LR-DAT-010 Current time initialization

\paragraph{LT-DAT-040 -- UNIX timestamp initialization}
The Date shall be initialized with the UNIX timestamp in seconds
\lstinline{1737283885} without error.

\textit{Tests: } LR-DAT-040 UNIX timestamp initialization

\paragraph{LT-DAT-050 -- UNIX timestamp output}
The Date initialized in LT-DAT-040 shall be converted to a UNIX
timestamp in seconds. The timestamp shall be be equal to \lstinline{1737283885}.

\textit{Tests: } LR-DAT-110 Date output UNIX timestamp

\paragraph{LT-DAT-060 -- Date string initialization}
The Date shall be initialized with the date string
\lstinline{19Jan2025 11:51:25} without error, and a UNIX timestamp output
will be queried, which must be equal to \lstinline{1737283885}.
This assumes the TimeZone singleton is set to \lstinline{Europe/Paris}.

\textit{Tests: } LR-DAT-050 Date string initialization

\paragraph{LT-DAT-070 -- Date string shortcuts 1}
The Date shall be initialized with the date string
\lstinline{19Jan2025 11:51} without error.
A UNIX timestamp output will be queried, which must be equal to
\lstinline{1737283860}.

\textit{Tests: } LR-DAT-060 Date string shortcuts

\paragraph{LT-DAT-080 -- Date string shortcuts 2}
The Date shall be initialized with the date string
\lstinline{19Jan2025 11} without error.
A UNIX timestamp output will be queried, which must be equal to
\lstinline{1737280800}.

\textit{Tests: } LR-DAT-060 Date string shortcuts

\paragraph{LT-DAT-090 -- Date string shortcuts 3}
The Date shall be initialized with the date string
\lstinline{19Jan2025} without error.
A UNIX timestamp output will be queried, which must be equal to
\lstinline{1737241200}.

\textit{Tests: } LR-DAT-060 Date string shortcuts

\paragraph{LT-DAT-100 -- Date string invalid}
The Date initialization shall emit an exception when provided
with the string \lstinline{GOOFY}.

\textit{Tests: } LR-DAT-070 Date string shortcuts

\paragraph{LT-DAT-110 -- Date output string}
The Date shall be initialized with a UNIX timestamp in seconds
\lstinline{1737283885}, the output string shall be queried and
must be equal to \lstinline{19Jan2025 11:51:25}.

\textit{Tests: } LR-DAT-080 Date output string

\paragraph{LT-DAT-120 -- Date output hours/minutes}
The Date shall be initialized with a UNIX timestamp in seconds
\lstinline{1737283885}, the output hours/minutes shall be queried
and must be equal to \lstinline{11:51}.

\textit{Tests: } LR-DAT-090 Date output hours/minutes

\paragraph{LT-DAT-130 -- Date output unambiguous string}
The Date shall be initialized with a UNIX timestamp in seconds
\lstinline{1737283885}, the output unambiguous string shall
be queried and must be equal to \lstinline{19Jan2025 11:51:25 +0100}.

\textit{Tests: } LR-DAT-100 Date output unambiguous string

\paragraph{LT-DAT-140 -- Date output day/month/year}
The Date shall be initialized with a UNIX timestamp in seconds
\lstinline{1737283885}, the output day/month/year string shall
be queried and must be equal to \lstinline{19Jan2025}.

\textit{Tests: } LR-DAT-120 Date output day/month/year

\paragraph{LT-DAT-150 -- Beginning of year}
The Date shall be initialized using the DatePoint YearBegin without error.
The day/month/year string is then queried, it must be equal to
\lstinline{01JanYYYY} with \lstinline{YYYY} whatever the current year
currently is in the time zone currently set in TimeZone.

\textit{Tests: } LR-DAT-030 Beginning of year

\paragraph{LT-DAT-160 -- Date comparison}
Two Date instances shall be initialized, the first with
UNIX timestamp in seconds \lstinline{1737283885}, the second with
\lstinline{1737283886}.
The comparison must show that,
\begin{itemize}
\item the first Date is \emph{lesser than} the second Date,
\item the second Date is \emph{greater than} the first Date.
\end{itemize}

\textit{Tests: } LR-DAT-140 Date comparison

\paragraph{LT-DAT-170 -- Date ago initialization}
A Date shall be initialized to 20 seconds ago without error.
A second Date initialized to \emph{now} will be initialized.
The unix timestamp corresponding to the two Dates will be
subtracted. The difference must be equal to 20 give or take 1 second.

\textit{Tests: } LR-DAT-150 Date ago initialization

\paragraph{LT-DAT-180 -- Date unambiguous string initialization}
A Date shall be initialized using the string
\lstinline{"28Jan2025 19:51:17 +0100"} without error.
Its UNIX timestamp shall be produced and must be equal to
\lstinline{1738090277}.

\textit{Tests: } LR-DAT-160 Date unambiguous string initialization

\subsubsection{DateRange}
\paragraph{LT-DTR-010 -- DateRange initialization}
Given a start Date initialized to UNIX timestamp \lstinline{1737283885},
and a stop Date initialized to UNIX timestamp \lstinline{1737283886},
a DateRange shall be initialized without error.

\textit{Tests: } LR-DTR-010 DateRange initialization

\paragraph{LT-DTR-020 -- DateRange ordering}
Given the start and stop Dates of LT-DTR-020 in reverse order,
the DateRange initialization shall emit an exception.

\textit{Tests: } LR-DTR-020 DateRange ordering

\paragraph{LT-DTR-030 -- Dates read access}
Given the DateRange initialized in LT-DTR-010, the start and stop
Dates shall be queried and their UNIX timestamp obtained.
The timestamps shall evaluate to the ones defined in LT-DTR-010.

\textit{Tests: } LR-DTR-030 Dates read access

\paragraph{LT-DTR-040 -- DateRange to strings}
Given the DateRange initialized in LT-DTR-010, the vector of
strings from the DateRange shall be queried. Each shall evaluate
to the same string given by the corresponding method for the start and stop
Dates (as specified in LR-DAT-080).

\textit{Tests: } LR-DTR-040 DateRange to strings

\paragraph{LT-DTR-050 -- DateRange to day strings}
Given the DateRange initialized in LT-DTR-010, the vector of
strings from the DateRange shall be queried. Each shall evaluate
to the same string given by the corresponding method for the start and stop
Dates (as specified in LR-DAT-120).

\textit{Tests: } LR-DTR-050 DateRange to day strings

\subsubsection{Day}
\paragraph{LT-DAY-010 -- Day ymd initialization}
A Day shall be initialized using a \lstinline{std::chrono::year_month_day}
object set to \lstinline{21Jan2025} without error.

\textit{Tests: } LR-DAY-020 year/month/day initialization

\paragraph{LT-DAY-020 -- DateRange representation}
Given a Day initialized to \lstinline{21Jan2025}, a valid DateRange
will be returned without error.

\textit{Tests: } LR-DAY-030 DateRange representation

\paragraph{LT-DAY-030 -- DateRange start and stop Date}
The DateRange returned by a Day initialized to \lstinline{21Jan2025}
shall have both:
\begin{itemize}
\item a start Date which returns a string equal to
  \lstinline{21Jan2025 00:00:00},
\item a stop Date which returns a string equal to
  \lstinline{22Jan2025 00:00:00}.
\end{itemize}

\textit{Tests: } LR-DAY-040 DateRange start and stop Date

\paragraph{LT-DAY-040 -- String representation}
A Day initialized to \lstinline{21Jan2025} shall return a string
representation equal to \lstinline{21Jan2025 Tue}.

\textit{Tests: } LR-DAY-050 String representation

\paragraph{LT-DAY-050 -- Now initialization}
A Day will be initialized to now without error. The DateRange will be queried
from this Day.
A Date is initialized to now, and its string day/month/year representation
is stored.
We check that the day/month/year string appended with \lstinline{" 00:00:00"} is
equal to the string representation of the DateRange start Date.

\textit{Tests: } LR-DAY-010 Now initialization

\paragraph{LT-DAY-060 -- Next}
Given a Day initialized to \lstinline{21Jan2025}, the \emph{next} method
shall be called without error and the string representation for the Day
shall be equal to \lstinline{22Jan2025 Wed}.

\textit{Tests: } LR-DAY-060 Next and previous

\paragraph{LT-DAY-070 -- Previous}
Given a Day initialized to \lstinline{21Jan2025}, the \emph{previous} method
shall be called without error and the string representation for the Day
shall be equal to \lstinline{20Jan2025 Mon}.

\textit{Tests: } LR-DAY-060 Next and previous

\subsubsection{Week}
\paragraph{LT-WEK-010 -- Date initialization}
Given a Date initialized to \lstinline{24Jan2025 18:09:30}, the Week
shall be initialized without error.

\textit{Tests: } LR-WEK-020 Date initialization

\paragraph{LT-WEK-020 -- DateRange conversion}
A Week initialized using the Date \lstinline{24Jan2025 18:09:30} shall
return a DateRange without error with start and stop Dates the string
representation of which are:
\begin{itemize}
\item start: \lstinline{20Jan2025 00:00:00}
\item stop: \lstinline{27Jan2025 00:00:00}
\end{itemize}

\textit{Tests: } LR-WEK-020 Date initialization, LR-WEK-030 DateRange conversion

\paragraph{LT-WEK-030 -- Now initialization}
The Week shall be initialized to the current calendar week without error.

\textit{Tests: } LR-WEK-010 Now initialization

\paragraph{LT-WEK-040 -- String representation}
A Week initialized using the Date \lstinline{24Jan2025 18:09:30} shall
return a string representation equal to \lstinline{"20Jan2025 W04"}.

\textit{Tests: } LR-WEK-040 String representation

\paragraph{LT-WEK-050 -- Array of days}
A week initialized using the Date \lstinline{24Jan2025 18:09:30} shall
return an array of Days, the string representations of which are,
in order,
\begin{enumerate}
\item \lstinline{"20Jan2025 Mon"}
\item \lstinline{"21Jan2025 Tue"}
\item \lstinline{"22Jan2025 Wed"}
\item \lstinline{"23Jan2025 Thu"}
\item \lstinline{"24Jan2025 Fri"}
\item \lstinline{"25Jan2025 Sat"}
\item \lstinline{"26Jan2025 Sun"}
\end{enumerate}

\textit{Tests: } LR-WEK-050 Array of days

\paragraph{LT-WEK-060 -- Next}
Given a Week initialized using the Date \lstinline{24Jan2025 18:09:30},
the method \emph{next} shall be called without error, and
the string representation of the Week obtained.
This string representation must be equal to \lstinline{"27Jan2025 W05"}.

\textit{Tests: } LR-WEK-060 Next and previous

\paragraph{LT-WEK-070 -- Previous}
Given a Week initialized using the Date \lstinline{24Jan2025 18:09:30},
the method \emph{previous} shall be called without error, and
the string representation of the Week obtained.
This string representation must be equal to \lstinline{"13Jan2025 W03"}.

\textit{Tests: } LR-WEK-060 Next and previous

\subsubsection{Duration}
\paragraph{LT-DUR-010 -- Zero initialization pass}
A Duration shall be default initialized without error.

\textit{Tests: } LR-DUR-010 Zero initialization

\paragraph{LT-DUR-020 -- Zero initialization seconds string}
A Duration default initialized shall return a seconds string
equal to \lstinline{"0 seconds"}.

\textit{Tests: } LR-DUR-010 Zero initialization, LR-DUR-040 Seconds string

\paragraph{LT-DUR-030 -- Seconds initialization pass}
A Duration shall be initialized from the seconds count \lstinline{104592}
without error.

\textit{Tests: } LR-DUR-020 Seconds initialization

\paragraph{LT-DUR-040 -- Seconds initialization value}
A Duration initialized from the seconds count \lstinline{104592}
shall return a seconds string equal to \lstinline{"104592 seconds"}.

\textit{Tests: } LR-DUR-020 Seconds initialization, LR-DUR-040 Seconds string

\paragraph{LT-DUR-050 -- Duration resolution}
Two Durations initialized respectively to \lstinline{104592} and
\lstinline{104593} shall return seconds strings equal to
\lstinline{"104592 seconds"} and \lstinline{"104593 seconds"}.

\textit{Tests: } LR-DUR-030 Duration resolution

\paragraph{LT-DUR-060 -- Hours string}
A Duration initialized from the seconds count \lstinline{104592}
shall return a hours string equal to \lstinline{"29.053 hours"}.

\textit{Tests: } LR-DUR-050 Hours string

\paragraph{LT-DUR-070 -- Days string}
A Duration initialized from the seconds count \lstinline{104592}
shall return a days string equal to \lstinline{"3.773 days"},
when provided with the number of hours in a day \lstinline{7.7}.

\textit{Tests: } LR-DUR-060 Days string

\paragraph{LT-DUR-080 -- Seconds short string}
A Duration initialized from the seconds count \lstinline{104592}
shall return a seconds short string equal to \lstinline{"104592"}.

\textit{Tests: } LR-DUR-070 Seconds short string

\paragraph{LT-DUR-090 -- Hours short string}
A Duration initialized from the seconds count \lstinline{104592}
shall return a hours short string equal to \lstinline{"29.053"}.

\textit{Tests: } LR-DUR-080 Hours short string

\paragraph{LT-DUR-100 -- Days short string}
A Duration initialized from the seconds count \lstinline{104592}
shall return a days short string equal to \lstinline{"3.773"},
when provided with the number of hours in a day \lstinline{7.7}.

\textit{Tests: } LR-DUR-090 Days short string

\paragraph{LT-DUR-110 -- Zero second short string}
A Duration default initialized to zero shall return a second short
string equal to \lstinline{" "} (a single whitespace character).

\textit{Tests: } LR-DUR-100 Zero second short string

\paragraph{LT-DUR-120 -- Zero hour short string}
A Duration default initialized to zero shall return a hour short
string equal to \lstinline{" "} (a single whitespace character).

\textit{Tests: } LR-DUR-110 Zero hour short string

\paragraph{LT-DUR-130 -- Zero day short string}
A Duration default initialized to zero shall return a day short
string equal to \lstinline{" "} (a single whitespace character),
when provided with the number of hours in a day \lstinline{7.7}.

\textit{Tests: } LR-DUR-120 Zero day short string

\paragraph{LT-DUR-140 -- Day string invalid hours}
A Duration initialized from the seconds count \lstinline{104592}
shall emit an exception when a day string is queried with a
number of hours in a day equal to \lstinline{-3}.

\textit{Tests: } LR-DUR-130 Day string invalid hours

\paragraph{LT-DUR-150 -- Day short string invalid hours}
A Duration initialized from the seconds count \lstinline{104592}
shall emit an exception when a day short string is queried with a
number of hours in a day equal to \lstinline{-3}.

\textit{Tests: } LR-DUR-140 Day short string invalid hours

\subsubsection{DurationDisplayer}
\paragraph{LT-DRD-010 -- DurationDisplayer initialization pass}
The DurationDisplayer shall be initialized with the number of hours
\lstinline{7.7} without error.

\textit{Tests: } LR-DRD-010 DurationDisplayer initialization pass.

\paragraph{LT-DRD-020 -- Hours string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall return a string representation equal to the one returned
by the hours string method of the Duration.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-040 Default format, LR-DRD-060 String
display.

\paragraph{LT-DRD-030 -- Hours short string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall return a short string representation equal to the one
returned by the hours short string method of the Duration.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-040 Default format, LR-DRD-070 Short string
display.

\paragraph{LT-DRD-040 -- Days string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall be \emph{cycled} and will return a string representation equal to
the one returned by the days string method of the Duration when provided
with a number of hours \lstinline{7.7}.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-050 Format cycling, LR-DRD-060 String
display.

\paragraph{LT-DRD-050 -- Days short string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall return a short string representation equal to
the one returned by the days short string method of the Duration when provided
with a number of hours \lstinline{7.7}.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-070 Short string
display.

\paragraph{LT-DRD-060 -- Seconds string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall be \emph{cycled} and will return a string representation equal to
the one returned by the seconds string method of the Duration.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-050 Format cycling, LR-DRD-060 String
display.

\paragraph{LT-DRD-070 -- Seconds short string display}
Given the DurationDisplayer singleton, and a Duration initialized
to the seconds count \lstinline{104592}, the DurationDisplayer
shall return a short string representation equal to
the one returned by the seconds short string method of the Duration.

\textit{Tests: } LR-DRD-020 DurationDisplayer singleton,
LR-DRD-030 Display formats, LR-DRD-070 Short string
display.

\paragraph{LT-DRD-080 -- Cycling back to hours}
The DurationDisplayer current format shall be cycled and
given a Duration initialized to the seconds count \lstinline{104592},
it shall return a string representation equal to the one returned
by the hours string method of the Duration.

\textit{Tests: } LR-DRD-050 Format cycling

\subsection{db\textunderscore lib}
\subsubsection{DB handle}
\paragraph{LT-DBL-010 -- Opening new DB}
The DB handle shall be used to open a new DB file in an existing
folder without error.

\textit{Tests: } LR-DBL-010

\paragraph{LT-DBL-020 -- Set user version}
The DB opened in LT-DBL-010 shall be initialized to version 3.

\textit{Tests: } LR-DBL-040

\paragraph{LT-DBL-030 -- Saving the DB}
The DB modified in LT-DBL-020 shall be saved and closed without error.

\textit{Tests: } LR-DBL-010

\paragraph{LT-DBL-040 -- Opening existing DB}
The DB handle shall be used to re-open the DB saved in LT-DBL-030
without error.

\textit{Tests: } LR-DBL-010

\paragraph{LT-DBL-050 -- User version check}
The DB re-opened in LT-DBL-040 shall be checked for user version 3
without error.

\textit{Tests: } LR-DBL-040

\paragraph{LT-DBL-060 -- User version check exception}
The DB re-opened in LT-DBL-040 shall be checked for user version 2
with an exception thrown due to version mismatch.

\textit{Tests: } LR-DBL-040

\paragraph{LT-DBL-070 -- User version get}
The DB re-opened in LT-DBL-040 shall be used to retrieve its user
version. The user version must be equal to 3.

\textit{Tests: } LR-DBL-050

\paragraph{LT-DBL-080 -- Opening DB in non-existent folder}
The DB handle shall throw an exception when used to open
a DB in \lstinline{tmpdir/non_existent/test_db.db}.

\textit{Tests: } LR-DBL-020

\paragraph{LT-DBL-090 -- Opening an invalid DB file}
The DB handle shall throw an exception when used to open a DB
given a text file named \lstinline{test_db.txt} containing
the string \lstinline{Hello}.

\textit{Tests: } LR-DBL-030

\paragraph{LT-DBL-100 -- Executing a valid statement}
The statement \lstinline{PRAGMA user_version = 4;} shall be executed
on an open DB. The user version must then be retrieved and be equal
to 4.

\textit{Tests: } LR-DBL-060

\paragraph{LT-DBL-110 -- Executing an invalid statement}
The statement \lstinline{PRAGMA user_version = ;} shall be executed and must
raise an exception.

\textit{Tests: } LR-DBL-070

\paragraph{LT-DBL-120 -- Preparing a valid statement}
The statement \lstinline{PRAGMA user_version;} shall be prepared
without error.

\textit{Tests: } LR-DBL-080

\paragraph{LT-DBL-130 -- Preparing an invalid statement}
The statement \lstinline{NOTASTATEMENT;} preparation shall
throw an exception.

\textit{Tests: } LR-DBL-090

\subsubsection{Statement wrapper}
The tests described hereafter use a common DB, on which tests are
executed sequentially.

\paragraph{LT-DBL-140 -- Executing statement}
The statement
\lstinline{CREATE TABLE contacts (contact_id INTEGER PRIMARY KEY, name TEXT NOT NULL, active BOOLEAN CHECK (active IN (0,1)), address TEXT, department INTEGER, available BOOLEAN);}
shall be executed successfully and return the value true.

\textit{Tests: } LR-DBL-100, LR-DBL-120

\paragraph{LT-DBL-150 -- Executing invalid statement}
The statement from LT-DBL-140 shall be retried, and throw an exception
this time.

\textit{Tests: } LR-DBL-110

\paragraph{LT-DBL-160 -- Repeat statement execution}
The statement \lstinline{INSERT INTO contacts (name) VALUES('John');}
shall be executed twice successfully, returning true each time.

\textit{Tests: } LR-DBL-100, LR-DBL-120

\paragraph{LT-DBL-170 -- Statement execution constraint violation}
The statement \lstinline{INSERT INTO contacts (name) VALUES(NULL);}
shall be executed and return false.

\textit{Tests: } LR-DBL-120

\paragraph{LT-DBL-180 -- Statement stepping}
The statement \lstinline{SELECT name FROM contacts;} shall be
stepped successfully and return true.

\textit{Tests: } LR-DBL-130, LR-DBL-150

\paragraph{LT-DBL-190 -- Statement stepping second}
The statement \lstinline{SELECT name FROM contacts;} shall
be stepped successfully a second time and return true.

\textit{Tests: } LR-DBL-130, LR-DBL-150

\paragraph{LT-DBL-200 -- Statement stepping no more rows}
The statement \lstinline{SELECT name FROM contacts;} shall
be stepped a third time and return false.

\textit{Tests: } LR-DBL-130, LR-DBL-150

\paragraph{LT-DBL-210 -- Statement stepping reset}
The statement \lstinline{SELECT name FROM contacts;} shall
be stepped a fourth time and return true.

\textit{Tests: } LR-DBL-160

\paragraph{LT-DBL-220 -- Statement stepping invalid}
The statement \lstinline{INSERT INTO contacts (contact_id, name) VALUES('John', 'John');}
shall throw an exception when stepped.

\textit{Tests: } LR-DBL-140

\paragraph{LT-DBL-230 -- Statement binding integer}
The integer \lstinline{1} shall be bound without error to the statement
\lstinline{SELECT name FROM contacts WHERE contact_id = ?;}.

\textit{Tests: } LR-DBL-170

\paragraph{LT-DBL-240 -- Statement binding string}
The string \lstinline{John} shall be bound without error to the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ? LIMIT 1;}.

\textit{Tests: } LR-DBL-170

\paragraph{LT-DBL-250 -- Binding too many parameters}
The strings \lstinline{John, Melissa} shall be bound to the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ? LIMIT 1;},
throwing an exception.

\textit{Tests: } LR-DBL-200

\paragraph{LT-DBL-260 -- Statement return boolean}
Given a \lstinline{contacts} table (LT-DBL-140)
with rows
\begin{itemize}
\item \lstinline{1 | John | 1},
\item \lstinline{2 | Melissa | 0},
\item \lstinline{3 | Luke | 1}.
\end{itemize}
the statement \lstinline{SELECT active FROM contacts WHERE name = ? LIMIT 1;}
with string parameter bound to \lstinline{John} shall be stepped and
a boolean return value shall be queried. The result must be equal to true.

\textit{Tests: } LR-DBL-180

\paragraph{LT-DBL-270 -- Statement return integer}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ? LIMIT 1;}
with string parameter bound to \lstinline{Melissa} shall be stepped
and an integer return value shall be queried. The result must be
equal to \lstinline{2}.

\textit{Tests: } LR-DBL-180

\paragraph{LT-DBL-280 -- Statement return string}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{1} shall be stepped and
a string shall be queried. The result must be equal to \lstinline{John}.

\textit{Tests: } LR-DBL-180

\paragraph{LT-DBL-290 -- Statement return shortcut}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id, name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{2} shall be given to the
shortcut get method. The results must be equal to \lstinline{2, Melissa}.

\textit{Tests: } LR-DBL-190

\paragraph{LT-DBL-300 -- Statement return shortcut reset}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id, name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{2} shall be given to the
shortcut get method. The shortcut shall be run twice.
The results must be equal to \lstinline{2, Melissa} each time.

\textit{Tests: } LR-DBL-190

\paragraph{LT-DBL-310 -- Statement column return wrong number of strings}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{1} shall be stepped,
and two strings asked for as results, triggering an exception.

\textit{Tests: } LR-DBL-210

\paragraph{LT-DBL-320 -- Statement column return wrong number of booleans}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT active FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{1} shall be stepped,
and two booleans asked for as results, triggering an exception.

\textit{Tests: } LR-DBL-210

\paragraph{LT-DBL-330 -- Statement column return wrong number of integers}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ?;}
with parameter bound to \lstinline{John} shall be stepped,
and two integers asked for as results, triggering an exception.

\textit{Tests: } LR-DBL-210

\paragraph{LT-DBL-340 -- Statement column return wrong type integer}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{1} shall be stepped,
and an integer asked for as result, triggering an exception.

\textit{Tests: } LR-DBL-220

\paragraph{LT-DBL-350 -- Statement column return wrong type boolean}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT name FROM contacts WHERE contact_id = ?;}
with parameter bound to \lstinline{1} shall be stepped,
and a boolean asked for as result, triggering an exception.

\textit{Tests: } LR-DBL-220

\paragraph{LT-DBL-360 -- Statement column return wrong type string}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ?;}
with parameter bound to \lstinline{John} shall be stepped,
and a string asked for as result, triggering an exception.

\textit{Tests: } LR-DBL-220

\paragraph{LT-DBL-370 -- Statement column return no rows}
Given the previous \lstinline{contacts} table with the previous rows,
the statement
\lstinline{SELECT contact_id FROM contacts WHERE name = ?;}
with parameter bound to \lstinline{Arnold} shall be stepped,
and an exception shall be thrown when a return value of each of
the following types shall be queried.
\begin{enumerate}
\item Boolean,
\item Integer,
\item String.
\end{enumerate}

\textit{Tests: } LR-DBL-230

\paragraph{LT-DBL-380 -- Statement column return null boolean}
Given the previous \lstinline{contacts} table with the previous rows,
the statement \lstinline{SELECT available FROM contacts where contact_id = 1;}
shall be stepped, and the return value queried. The result must be equal to
false.

\textit{Tests: } LR-DBL-240

\paragraph{LT-DBL-390 -- Statement column return null integer}
Given the previous \lstinline{contacts} table with the previous rows,
the statement \lstinline{SELECT department FROM contacts where contact_id = 1;}
shall be stepped, and the return value queried. The result must be equal to
0.

\textit{Tests: } LR-DBL-240

\paragraph{LT-DBL-400 -- Statement column return null string}
Given the previous \lstinline{contacts} table with the previous rows,
the statement \lstinline{SELECT address FROM contacts where contact_id = 1;}
shall be stepped, and the return value queried. The result must be equal to
the empty string.

\textit{Tests: } LR-DBL-240

\subsection{suggestion\textunderscore lib}
\paragraph{LT-SUG-010 -- Empty set of choice strings}
Given the query string \lstinline{fox} and the empty set for strings
to choose from, the suggestion matcher shall return the empty string.

\textit{Tests: } LR-SUG-020

\paragraph{LT-SUG-020 -- Empty query string}
Given an empty string as query and the set of strings to choose
from \lstinline{banana, fox}, the suggestion matcher shall
return the empty string.

\textit{Tests: } LR-SUG-030

\subsubsection{Prefix matching}
\paragraph{LT-SUG-030 -- Prefix match with case}
Given the query \lstinline{Bana} and the set of strings to choose
from \lstinline{Banana, Fox}, the suggestion matcher shall
return the string \lstinline{Banana}.

\textit{Tests: } LR-SUG-060

\paragraph{LT-SUG-040 -- Prefix match without case}
Given the query \lstinline{fo} and the set of strings to choose from
\lstinline{Banana, Fox}, the suggestion matcher shall return
the string \lstinline{Fox}.

\textit{Tests: } LR-SUG-010

\subsubsection{Substring matching}
\paragraph{LT-SUG-050 -- Base substring case}
Given the query \lstinline{ana} and the set of strings
\lstinline{banana}, the suggestion matcher shall return the
string \lstinline{banana}.

\textit{Tests: } LR-SUG-060

\paragraph{LT-SUG-060 -- Earliest substring}
Given the query \lstinline{ana} and the set \lstinline{bbanana, banana},
the suggestion matcher shall return the string \lstinline{banana}.

\textit{Tests: } LR-SUG-070

\paragraph{LT-SUG-070 -- Shortest substring}
Given the query \lstinline{ana} and the set \lstinline{banana, bananana},
the suggestion matcher shall return the string \lstinline{banana}.

\textit{Tests: } LR-SUG-080

\paragraph{LT-SUG-080 -- First alphabetical substring}
Given the query \lstinline{ana} and the set \lstinline{banana, banane},
the suggestion matcher shall return the string \lstinline{banana}.

\textit{Tests: } LR-SUG-090

\subsubsection{Fuzzy matching}
\paragraph{LT-SUG-090 -- Out of order}
Given the query \lstinline{fence over jumps} and the set
\lstinline{"The brown fox", "jumps over the fence"}, the suggestion
matcher shall return \lstinline{"jumps over the fence"}.

\textit{Tests: } LR-SUG-100

\paragraph{LT-SUG-100 -- Small typo}
Given the query \lstinline{juppiter} and the set
\lstinline{Jupiter, Saturn}, the suggestion matcher shall return
\lstinline{Jupiter}.

\textit{Tests: } LR-SUG-110

\paragraph{LT-SUG-110 -- No match}
Given the query \lstinline{yyy} and the set
\lstinline{banana, fox}, the suggestion matcher shall return the
empty string.

\textit{Tests: } LR-SUG-120, LR-SUG-010

\paragraph{LT-SUG-120 -- Non-letters}
Given the query \lstinline{bana} and the set
\lstinline{%/.$BAnafu, Fox}, the suggestion matcher shall return
the string \lstinline{%/.$BAnafu}.

\textit{Tests: } LR-SUG-040, LR-SUG-050

\subsection{log\textunderscore lib}
The logger being tested is a singleton. We test the cases which do not
yield a valid instance first.

\begin{minipage}{\linewidth}
  \begin{lstlisting}[caption={Existing log file with old and new entries},
    label={lst:existing_log}]
<now - 300 seconds> [debug] : Older entry, to remove.
<now - 60 seconds> [debug] : Newer entry, to keep.
\end{lstlisting} \end{minipage}

\paragraph{LT-LOG-010 -- Opening log file in non-existent folder}
Given a valid \lstinline{tmpdir}, the logger initialization
shall be provided with the log filepath
\lstinline{tmpdir/non_existent/test_log.log},
the log levels \lstinline{"info"}, and the age threshold \lstinline{180}.
An exception must be thrown.

\textit{Tests: } LR-LOG-050 Log file exception.

\paragraph{LT-LOG-020 -- Unknown log levels exception}
Given a valid \lstinline{tmpdir}, the logger initialization
shall be provided with the log filepath \lstinline{"tmpdir/test_log.log"},
the log levels \lstinline{"wrong_level"}, and the age threshold
\lstinline{180}.
An exception must be thrown.

\textit{Tests: } LR-LOG-140 Unknown log levels exception.

\paragraph{LT-LOG-030 -- Log file invalid}
Given an existing log file at \lstinline{"tmpdir/test_log.log"},
filled with the following text,
\begin{lstlisting}
NOT AN ENTRY
\end{lstlisting}
the logger initialization shall be provided with the log filepath,
the log levels \lstinline{"info"}, and the age threshold \lstinline{180}.
An exception must be thrown.

\textit{Tests: } LR-LOG-060 Log file invalid.

\paragraph{LT-LOG-040 -- Log valid initialization}
Given an existing log file at \lstinline{"tmpdir/test_log.log"},
filled with \cref{lst:existing_log} with the dates in brackets \lstinline{<>}
replaced by the proper dates, the logger initialization shall be
provided with the log filepath, the log levels \lstinline{"info", "debug"}
and the age threshold \lstinline{180}.
The logger must be initialized without error.

\textit{Tests: } LR-LOG-040 Log file, LR-LOG-070 Log levels initialization,
                 LR-LOG-080 Log maximum age initialization.

\paragraph{LT-LOG-050 -- Log cleanup}
Given the valid initialization of the logger, the log file
shall be opened, a single line of text must be found.
This line must have the string suffix
\lstinline{" [debug] : Newer entry, to keep."}.

\textit{Tests: } LR-LOG-030 Log cleanup.

\paragraph{LT-LOG-060 -- Logging}
The log method shall be called with the message
\lstinline{"Basic log message."} and the default log level.
It must execute without error.

\textit{Tests: } LR-LOG-010 Logging.

\paragraph{LT-LOG-070 -- Log entry format}
Given the successfully created log message (LT-LOG-060),
the log file shall be opened and be found to contain two lines.
The last line is examined. It must contain the suffix
\lstinline{" [info] : Basic log message."}.
The date part of the line will be parsed and be found to agree
with the current date with at most 10 seconds of error.

\textit{Tests: } LR-LOG-090 Log entry format.

\paragraph{LT-LOG-080 -- Logging custom active level}
The log method shall be called with the message
\lstinline{"Custom active log level."} and the log level
\lstinline{debug}. It must execute without error.
The log file shall be opened and be found to contain three lines.
The last line is examined. It must contain the suffix
\lstinline{" [debug] : Custom active log level."}.

\textit{Tests: } LR-LOG-020 Log levels.

\paragraph{LT-LOG-090 -- Logging custom inactive level}
The log method shall be called with the message
\lstinline{"Custom inactive log level."} and the log level
\lstinline{error}. It must execute without error.
The log file shall be opened and be found to contain three lines
(no line was added).

\textit{Tests: } LR-LOG-020 Log levels.

\paragraph{LT-LOG-100 -- Log chronometer}
The logger \lstinline{tick} shall be called without error.
In succession, the logger \lstinline{tock} shall be called without error.
The log file shall be opened and be found to contain four lines
(one line added for the chronometer logging).

\textit{Tests: } LR-LOG-100 Log chronometer.

\paragraph{LT-LOG-110 -- Log chronometer message}
The logger \lstinline{tick} shall be called,
and in succession, the logger \lstinline{tock} method shall
be called with the message \lstinline{"Chronometer duration: "}.
The log file shall be opened and be found to contain five lines
(one line added for the chronometer logging).

\textit{Tests: } LR-LOG-110 Log chronometer message.

\paragraph{LT-LOG-120 -- Log chronometer entry format}
The log file shall be opened. The two last lines are examined.
Both must contain a parsable full date followed by
the string \lstinline{" [debug] : "}.

The first line must then contain a sequence of digits separated
by a dot, with three digits after the dot. When parsed, this number
must be found to be less than \lstinline{1000.0}. The line suffix
must be \lstinline{" ms."}.

The second line must contain the message
\lstinline{"Chronometer duration: "}, followed by what the first line
contained.

\textit{Tests: } LR-LOG-120 Log chronometer entry format.

\paragraph{LT-LOG-130 -- Log message multiline exception}
The log method shall be called with a message containing
a newline character \lstinline{\n}, it must throw an exception.

\textit{Tests: } LR-LOG-130 Log message multiline exception.

\paragraph{LT-LOG-140 -- Chronometer message multiline exception}
The logger \lstinline{tick} shall be called.
The logger \lstinline{tock} shall then be called with a message
containing a newline character \lstinline{\n}, it must throw
an exception.

\textit{Tests: } LR-LOG-130 Log message multiline exception.
